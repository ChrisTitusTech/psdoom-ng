--- src/doom/d_main.c	2016-01-14 10:28:08.774135379 -0800
+++ src/doom/d_main.c	2016-01-14 10:29:21.969908903 -0800
@@ -2,6 +2,7 @@
 //-----------------------------------------------------------------------------
 //
 // Copyright(C) 1993-1996 Id Software, Inc.
+// Copyright(C) 2000 by David Koppenhofer
 // Copyright(C) 2005 Simon Howard
 //
 // This program is free software; you can redistribute it and/or
@@ -857,6 +894,15 @@
     int             p;
     char            file[256];
     char            demolumpname[9];
+// *** PID BEGIN ***
+    // Pointer to environment variable string to determine username.
+    char	*whoami = NULL;
+
+    // Value to check whether there were any userlist-related flags
+    // given on the command line.  Used to determine whether to
+    // set up default userlist parameters.
+    boolean	userlist_arg_given = false;
+// *** PID END ***
 
     M_FindResponseFile ();
 
@@ -944,6 +990,10 @@
 #endif
 
     iwadfile = D_FindIWAD();
+// *** PID BEGIN ***
+    psdoom1wad = D_FindWADByName("psdoom1.wad");
+    psdoom2wad = D_FindWADByName("psdoom2.wad");
+// *** PID END ***
 
     // None found?
 
@@ -1192,6 +1381,30 @@
 
     DEH_printf("W_Init: Init WADfiles.\n");
     D_AddFile(iwadfile);
+   
+// *** PID BEGIN ***
+// If the command-line flag to suppress auto-loading of custom
+// ps management levels is *not* there, load the appropriate level.
+    p = M_CheckParm ("-nopslev");
+    if (p)
+    {
+// Add psdoom1.wad if this is registered (Doom 1) or retail (Ultimite Doom).
+// If we loaded it, set the flag to true so we can place the monsters in the
+// correct positions.
+		if ( gamemode == registered || gamemode == retail ){
+			D_AddFile(iwadfile);
+			ps_level_loaded = true;
+		}
+// Add psdoom2.wad if this is commercial (Doom 2) and not an add-on pack.
+// If we loaded it, set the flag to true so we can place the monsters in the
+// correct positions.
+		if ( gamemode == commercial && gamemission == doom2 ) {
+			D_AddFile(iwadfile);
+			ps_level_loaded = true;
+		}
+    }
+// *** PID END ***
+ 
 
 #ifdef FEATURE_WAD_MERGE
 
